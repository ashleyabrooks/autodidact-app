{% extends 'base.html' %}

<link rel="stylesheet" href="/static/stylesheet.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

{% block title %}Curriculum{% endblock %}

{% block content %}
<h1>Curriculum</h1>

<body>
    <!--Add Content button: -->
    <a href='/curriculum/{{ topic_id }}/add-content'><button type='button' id='add-content-button'> + Add Content </button></a>
    <br><br>
    <a href='/topics'><button type='button' id='back-to-topics-button'> &#8592; Back to Topics </button></a>
    <br><br>

<!--Show curriculum list: -->

<div id='curriculum-list'>  
    {% set count = 0 %}   
    {% for item in curric_items %}
        <div class='curric-item' data-id={{ count }}>
            <a href='https://www.{{ item.content_url }}'>{{ item.content_title }}</a><br>
        </div>
    {% set count = count + 1 %}
    {% endfor %}
</div>

<!--Save Order button: -->
<button id='save-curric-order-button'>Save Curriculum Order</button>

<script src="http://rubaxa.github.io/Sortable/Sortable.js"></script>
  
<script>

    var order;

    // Make curriculum list sortable
    var curriculumList = document.getElementById('curriculum-list');
    var curricObj = Sortable.create(curriculumList);


    // Define success function for save-curric-order-button
    function saveCurricOrder() {
        order = curricObj.toArray();
        console.log(order)
    }

    function recreateCurricOrder() {
        $.get('/get-order', order);
        curriculumList.sort(order.reverse());
    }

    // Upon button click, save order in an array
    $('#save-curric-order-button').on('click', function () {
        order = curricObj.toArray();
        $.post('/save-order', order);
    });

    //When page load is complete, order curriculum by array saved in var order
    window.onload = recreateCurricOrder;

    // after saveCurricOrder, AJAX post request ($.post) to save order variable
    // Look at AJAX demo in ajax-exercise.js function orderMelons
    // passes data to route in Flask ex: /order-melons route
    // when page loads, AJAX request to get order list from route



</script>

</body>

{% endblock %}